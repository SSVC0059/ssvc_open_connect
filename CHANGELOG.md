# CHANGELOG

Все заметные изменения в этом проекте документируются в этом файле.  
Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),  
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

[0.2.1.7] - 2025-04-13

### Новое в версии

- Добавлен функционал управления настройками SSVC
- Добавлено отображение встроенным светодиодом (либо внешним на 48 пине) статуса подключения к WIFI (только для ESP32-S3)
  Красный - WIFI не активен (модуль загружается)
  Голубой - режим точки доступа клиентов нет
  Синий - Режим точки доступа есть клиент
  Желтый - подключен к WIFI - клиентов нет
  Зеленый - Подключен к WIFI есть клиент.

### Изменено

- Переработан обмен между ESP32 и клиентским приложением. Это позволило существенно улучшить надежность соединения.
- Переработан межанизм отправки команд SSVC. реализована потокобезопасность отправки команд.
- Обновление svelte до версии 5
- Обновление PsychicHttp до версии v1.2.1
- Поддержка сохранения статичных данных на встроенную flash
- Исправлена ошибка не верного округления значения работы клапана
- Прочие мелкие исправления и оптимизация


# [0.2.0.2] - 2025-02-02

### Изменено

- Исправление работы кнопок управления процессом
- Исправление времени жизни кеша. Время жизни кеша повышен до 1 дня
- Небольшие исправления ночной темы
- Добавлено отображение параметров countdown и time
- исправлена ошибка отображения периода работы клапана (округление до 2х знаков после точки)

# [0.2.0.1] - 2024-12-29

### Изменено

- Поддержка SSVC API 1.1 
- Веб интерфейс переведен на новый графический дизайн.
- Глубокая переработка серверной части.
- Прочие изменения в плане оптимизации производительности
- Поддержка микроконтроллера ESP32-S3-n8r2

### Удалено
- Откат версии PsychicHttp на более старую. 


## [0.1.9] - 2024-12-22

### Изменено

- Обновление PsychicHttp до v1.2.1
- Прочие измения в плане оптимизации производительности

## [0.1.8] - 2024-12-11

### Изменено:
- Для ESP32-S3 явно задана мощность TX WIFI - WIFI_POWER_18_5dBm 
- Хранение данных графика уменьшено с 24 до 2х часов и с периодичностью с 10 до 20 секунд на точку

### Удалено
- Аутентификация в приложении и все что с ней связано
- Убраны не поддерживаемые цели сборки из Platformio.ini
- Для ERS32-4m убрана возможность загрузки прошивки с Github



## [0.1.7_ исправительный] - 2024-12-09

### Изменено:
- График температуры разделен на 2 для каждого из датчиков. 
- Отображение данных на графике теперь идет с начала включения контроллера и данные хранятся за последние 24 часа.
- График теперь не привязан к одному браузеру и корректно открывается после перезапуска браузера и открытия на другом устройстве
- Изменение внешнего вида полей. Условные единицы отображаются теперь после значений
- Данные температуры теперь ведутся с четом коррекции по давлению, и значения аналогичны отображаемым на дисплее

### Исправлено
- После нажатия кнопок управления SSVC окно с подтверждением теперь содержит правильное описание
- Исправлена ошибка CI проекте github

### Стабильность
- Изменение приоритетов rtos задач openconnet, для устранения случая, когда задачи обработки телеметрии блокировали работу wifi и веб. страницы
- для контроллера ESP32-S3 выбран отдельный конфигурационный файл. Ожидается, что это должно более корректно использовать его возможности
- Все задачи при которых происходит длительная запись данных обернуты мьютексом. Необходимо для исключения проблем повреждения данных при одновременной записи и чтении.

### Удалено
- Библиотека MQTT для контроллеров семейства ESP32-wroom-1 c 4MB памяти. В дальнейшем появится только на ESP32-S3-16M


## [0.1.6_предрелиз] - 2024-12-05
### Добавлено:
- Отображение графика температуры  датчиков колонны и куба
- Отображение показаний отбора в мл
- Повышение cкорости загрузки данных

### Изменено:
- Большое изменение серверной части, для повышения стабильности связи и возможности дальнейшего развития

### Удалено:
- Уведомления о взаимосвязи с контроллером. Сейчас они реализованы на стороне сервера.

### Пока не работает:

- Не реализован автопроверка связи через запросы AT. Данная задача в работе

## [0.1.5] - 2024-11-25  
### Изменено:
- Передача сообщений через websocket переведено с JSON на MessagePack, что положительно повлияет на уменьшение размера передаваемых данных


## [0.1.4] - 2024-11-21
### Добавлено:
- Поддержка анимационных событий (event) с тремя уровнями важности: Уведомление, Внимание, Ошибка.
- Добавлена кнопка ручной загрузки настроек SSVC

### Изменено:
- Повышение стабильности соединения.
- Изменение текста информационных сообщений 

## [0.1.3] - 2024-11-20
### Добавлено:
- Улучшение стабильности связи с SSVC
  
### Изменено:
- Исправление ошибки проверки поддерживаемой версии SSVC
- Исправление критической ошибки при получении данных системы


## [0.1.2] - 2024-11-17
### Добавлено
- Поддержка mDNS. Теперь контроллер после подключения к wifi должен быть доступен под url http://ssvcopenconnect.local
- В режиме ожидания SSVC кнопки управления становятся не активными
  
### Изменено
- Исправлено отображение кнопок упрвления ssvc на экранах небольшого размера
- Локализация окна обновления программы
- Часовой пояс по умолчанию изменен на Europe/Moscow


## [0.1.1] - 2024-11-16
### Добавлено
- Поддержка телеметрии и команд до версии SSVC0059v2 2.2.37
- Контроль ответа SSVC на команды
- Контроль минимальной версии SSVC
- Доработана форма настроек. Сделана группировка по блокам
- Множество прочих мелких доработок
---